{% extends 'base.html.twig' %}

{% block title %}Matiere index{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .error-message {
            background-color: #F31010; /* Rouge */
            color: #fff; /* Blanc */
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .table {
            background-color: #f2f2f2; /* Gris clair */
        }
        .table th {
            color: #F31010; /* Rouge */
        }
        .table td {
            color: #333; /* Couleur de texte par défaut */
        }
    </style>
{% endblock %}

{% block body %}
    <h1>Matiere index</h1>

    <div class="input-group mb-3">
        <input type="text" id="searchInput" class="form-control" placeholder="Rechercher une matière" oninput="search()">
        <button class="btn btn-outline-secondary" type="button" id="searchButton">Rechercher</button>
    </div>


     <div class="btn-group">
        <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            Trier par Nom de Matière
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ path('app_matiere_indexEtud', {'sort': 'asc'}) }}">Ascendant</a></li>
            <li><a class="dropdown-item" href="{{ path('app_matiere_indexEtud', {'sort': 'desc'}) }}">Descendant</a></li>
        </ul>
    </div>

    <table class="table" id="matiereTable">
        <thead>
            <tr>
                <th>Nom Matiere</th>
                <th>Idenseignant</th>
                <th>Nombre d'heure</th>
                <th>Coefficient</th>
                <th>Semester</th>
                <th>Credit</th>
                <th>Plandetude</th>
            </tr>
        </thead>
        <tbody>
        {% for matiere in matieres %}
            <tr class="matiereRow">
                <td>{{ matiere.nomm }}</td>
                <td>{{ matiere.idenseignant }}</td>
                <td>{{ matiere.nbrheure }}</td>
                <td>{{ matiere.coefficient }}</td>
                <td>{{ matiere.semester }}</td>
                <td>{{ matiere.credit }}</td>
                <td>{{ matiere.idplandetude.nomprogramme }}</td>
            </tr>
        {% else %}
            <tr>
                <td colspan="7">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <script>
        function search() {
            let input, filter, table, rows, cells, i, txtValue;
            input = document.getElementById('searchInput');
            filter = input.value.toUpperCase();
            table = document.getElementById('matiereTable');
            rows = table.getElementsByClassName('matiereRow');

            for (i = 0; i < rows.length; i++) {
                cells = rows[i].getElementsByTagName('td');
                let found = false; // Ajoutez cette ligne pour suivre l'état de la recherche
                for (let j = 0; j < cells.length; j++) {
                    let cell = cells[j];
                    if (cell) {
                        txtValue = cell.textContent || cell.innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            found = true;
                            break; // Si un terme est trouvé, sortez de la boucle interne
                        }
                    }
                }
                // Afficher ou masquer la ligne en fonction de si elle contient le terme recherché
                if (found) {
                    rows[i].style.display = '';
                } else {
                    rows[i].style.display = 'none';
                }
            }
        }

        document.getElementById('searchButton').addEventListener('click', function() {
            search();
        });
    </script>

{% endblock %}
