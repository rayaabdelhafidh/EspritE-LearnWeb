{% extends 'baseback.html.twig' %}

{% block title %}Emplois{% endblock %}

{% block body %}
    <h1>Emplois</h1>

<form method="GET" action="{{ path('app_emploi_index') }}" style="margin-left: 20px;">
    <label for="premierdate">Filtrer par date de début: </label>
    <select name="premierdate" id="premierdate">
        <option value="">Tout</option>
        {% for emploi in premierdates %}
            {% set premierdate = emploi.premierdate %}
            <option value="{{ premierdate|date('Y-m-d') }}">{{ premierdate|date('Y-m-d') }}</option>
        {% endfor %}
    </select>
    <button type="submit" name="filter">Filtrer</button>
</form>





   <div class="section-title">
            <input type="text" id="searchInput" class="form-control" placeholder="Search" oninput="search()">
        </div>

    <a href="{{ path('app_emploi_new') }}">Créer Emploi</a>
     <a href="{{ path('app_emploi_pdf') }}" class="btn btn-primary">Générer PDF</a>
      <a href="{{ path('app_emploi_pdf_send') }}" class="btn btn-primary">send email</a>

generate_qr_code
    <table class="table">
        <thead>
            <tr>
                <th>Filiere</th>
                <th>Niveau</th>
                <th>Classe</th>
                <th>Premierdate</th>
                <th>Dernierdate</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for emploi in pagination %}
            <tr>
                <td>{{ emploi.classe.Filiere }}</td>
                <td>{{ emploi.classe.niveaux }}</td>
                <td>{{ emploi.classe.nomClasse }}</td>
                <td>{{ emploi.premierdate ? emploi.premierdate|date('Y-m-d') : '' }}</td>
                <td>{{ emploi.dernierdate ? emploi.dernierdate|date('Y-m-d') : '' }}</td>
                <td style="display: flex; align-items: center;">
                    <a href="{{ path('app_emploi_show', {'id': emploi.id}) }}">afficher</a>
                    <a href="{{ path('app_emploi_edit', {'id': emploi.id}) }}"  style="margin-left: 17px;">modifer</a>
                    <div style="margin-left: 10px;">{{ include('emploi/_delete_form.html.twig', {'emploi': emploi}) }}</div>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="4">no records found</td>
            </tr>
        {% endfor %}

          <img src="{{ qrCodeImagePath }}" alt="QR Code Image">
        </tbody>
    </table>

<div style="display: flex; justify-content: center; margin-top: 20px;">
    {{ knp_pagination_render(pagination) }}
</div>

 <script>
        function search() {
          
            let input = document.getElementById("searchInput");
            let filter = input.value.toUpperCase();
   
            let rows = document.querySelectorAll("tbody tr");
           
            rows.forEach(row => {
                let found = false;
                
                let cells = row.querySelectorAll("td");
                cells.forEach(cell => {
                    let text = cell.textContent || cell.innerText;
                    if (text.toUpperCase().includes(filter)) {
                        found = true;
                    }
                });
                if (found) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            });
        }
    </script>
{% endblock %}
