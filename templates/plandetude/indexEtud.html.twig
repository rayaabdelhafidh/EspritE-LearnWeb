{% extends 'base.html.twig' %}

{% block title %}Plandetude index{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .error-message {
            background-color: #F31010; /* Rouge */
            color: #fff; /* Blanc */
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .table {
            background-color: #f2f2f2; /* Gris clair */
        }
        .table th {
            color: #F31010; /* Rouge */
        }
        .table td {
            color: #333; /* Couleur de texte par défaut */
        }
    </style>
{% endblock %}

{% block body %}
    <h1>Plandetude index</h1>

    <div class="input-group mb-3">
        <input type="text" id="searchInput" class="form-control" placeholder="Rechercher un programme" oninput="search()">
        <button class="btn btn-outline-secondary" type="button" id="searchButton">Rechercher</button>
    </div>

 <div class="btn-group">
        <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            Trier par Nom de Programme
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ path('app_plandetude_indexEtud', {'sort': 'asc'}) }}">Ascendant</a></li>
            <li><a class="dropdown-item" href="{{ path('app_plandetude_indexEtud', {'sort': 'desc'}) }}">Descendant</a></li>
        </ul>
    </div>

    <table class="table" id="plandetudeTable">
        <thead>
            <tr>
                <th>Nom Programme</th>
                <th>Niveau</th>
                <th>Durée Total</th>
                <th>Crédits Total</th>
            </tr>
        </thead>
        <tbody>
        {% for plandetude in plandetudes %}
            <tr class="plandetudeRow">
                <td>{{ plandetude.Nomprogramme }}</td>
                <td>{{ plandetude.Niveau }}</td>
                <td>{{ plandetude.Dureetotal }}</td>
                <td>{{ plandetude.Creditsrequistotal }}</td>
            </tr>
        {% else %}
            <tr>
                <td colspan="4">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <script>
        function search() {
            let input, filter, table, rows, cells, i, txtValue;
            input = document.getElementById('searchInput');
            filter = input.value.toUpperCase();
            table = document.getElementById('plandetudeTable');
            rows = table.getElementsByClassName('plandetudeRow'); //Ensuite, elle parcourt toutes les lignes (<tr>) de la table en utilisant rows = table.getElementsByClassName('plandetudeRowEnsuite, elle parcourt toutes les lignes (<tr>) de la table en utilisant rows = table.getElementsByClassName('plandetudeRow

            for (i = 0; i < rows.length; i++) {
                cells = rows[i].getElementsByTagName('td');   //Pour chaque ligne, elle parcourt ensuite toutes les cellules (<td>) 
                let found = false; // Ajoutez cette ligne pour suivre l'état de la recherche
                for (let j = 0; j < cells.length; j++) {
                    let cell = cells[j];
                    if (cell) {
                        txtValue = cell.textContent || cell.innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            found = true;
                            break; // Si un terme est trouvé, sortez de la boucle interne
                        }
                    }
                }
                // Afficher ou masquer la ligne en fonction de si elle contient le terme recherché
                if (found) {
                    rows[i].style.display = '';
                } else {
                    rows[i].style.display = 'none';
                }
            }
        }

        document.getElementById('searchButton').addEventListener('click', function() {
            search();
        });
    </script>

{% endblock %}
