{% extends 'base.front.html.twig' %}
{% block event %}
<section class="section" id="features">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 offset-lg-3">
                <div class="section-heading">
                    <h2>Our <em>Events</em></h2>
                    <img src="{{ asset('front/assets/images/line-dec.png')}}" alt="waves">
                </div>
            </div>
            <div class="col-lg-6">
                <ul class="features-items">
                    <li class="feature-item">
                        <div>
                            <div class="container">
                                <nav class="navbar navbar-light bg-light">
                                    <div class="sidebar-search">
                                        <div class="input-group custom-search-form">
                                            <input type="text" id="search"  class="form-control mr-sm-2"  placeholder="Search An Event">
                                        </div>
                                    </div>
                                    <div>
                                        <form class="form-inline my-2 my-lg-0" method="post" action="{{ path('evenement_tri') }}">
                                            <label>
                                                <select class="form-control" name="type">
                                                    <option>Croissant</option>
                                                    <option>DÃ©croissant</option>
                                                </select>
                                            </label>
                                            <input type="submit" class="btn btn-success" value="Trier!">
                                        </form>
                                    </div>
                                </nav>
                                <ul class="nav" id="side-menu">
                                    <li>
                                        <a href="#"> <span class="fa arrow"></span></a>
                                        <ul class="nav nav-second-level" id="entitiesNav">
                                        </ul>
                                    </li>
                                </ul>
                                <br><br>
                                <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

                                <script type="text/javascript">
                                    jQuery(document).ready(function() {
                                        var searchRequest = null;
                                        $("#search").keyup(function() {
                                            var minlength = 1;
                                            var that = this;
                                            var value = $(this).val();
                                            var entitySelector = $("#entitiesNav").html('');
                                            if (value.length >= minlength ) {
                                                if (searchRequest != null)
                                                    searchRequest.abort();
                                                searchRequest = $.ajax({
                                                    type: "GET",
                                                    url: "{{ path('ajax_search') }}",
                                                    data: {
                                                        'q' : value
                                                    },
                                                    dataType: "text",
                                                    success: function(msg){
                                                        //we need to check if the value is the same
                                                        if (value===$(that).val()) {
                                                            var result = JSON.parse(msg);
                                                            $.each(result, function(key, arr) {
                                                                $.each(arr, function(id, value) {
                                                                    if (key === 'evenements') {
                                                                        if (id !== 'error') {
                                                                            entitySelector.append('<li><b>'+value[1]+'</b><a href="/evenement/'+id+'"><img src="/assets/img/'+value[0]+'" style="width: 60px; height: 60px"/></a></li>');
                                                                        } else {
                                                                            entitySelector.append('<li class="errorLi">'+value+'</li>');
                                                                        }
                                                                    }
                                                                });
                                                            });
                                                        }
                                                    }
                                                });
                                            }
                                        });
                                    });
                                </script>

                                
                                <table>
                                    <tr>
                                        {% for evenement in evenements %}
                                            <td>
                                                <div class="container-fluid row">
                                                    <div class="card" style="width: 18rem;">
                                                        <img class="card-img-top" src="{{ asset("assets/img/") }}{{evenement.photo}}" alt="Card image cap">
                                                        <div class="card-body">
                                                            <h5 class="card-title">{{ evenement.titre }}</h5>
                                                            <p class="card-text">{{ evenement.description }}.</p>
                                                            <a href="{{ path('evenement_participation',{'id': evenement.id }) }}" class="btn btn-primary">Show</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        {% endfor %}
                                    </tr>
                                </table>
                                {# {{ knp_pagination_render(evenements) }} #}
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>
{% endblock %}