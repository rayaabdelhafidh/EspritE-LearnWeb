{% extends 'baseback.html.twig' %}

{% block title %}Gestion des classes{% endblock %}

{% block body %}
    <h1>Gestion des classes</h1>
                                    <nav class="navbar navbar-light bg-light">
                                    <div class="sidebar-search">
                                        <div class="input-group custom-search-form">
                                            <input type="text" id="search"  class="form-control mr-sm-2"  placeholder="Search An Event">
                                        </div>
                                    </div>
                                    <div>
                                        <form class="form-inline my-2 my-lg-0" method="post" action="{{ path('evenement_tri') }}">
                                            <label>
                                                <select class="form-control" name="type">
                                                    <option>Croissant</option>
                                                    <option>Décroissant</option>
                                                </select>
                                            </label>
                                            <input type="submit" class="btn btn-success" value="Trier!">
                                        </form>
                                    </div>
                                </nav>
                                <ul class="nav" id="side-menu">
                                    <li>
                                        <a href="#"> <span class="fa arrow"></span></a>
                                        <ul class="nav nav-second-level" id="entitiesNav">
                                        </ul>
                                    </li>
                                </ul>
                                <br><br>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
                                
                                <script type="text/javascript">
                                    jQuery(document).ready(function() {
                                        var searchRequest = null;
                                        $("#search").keyup(function() {
                                            var minlength = 1;
                                            var that = this;
                                            var value = $(this).val();
                                            var entitySelector = $("#entitiesNav").html('');
                                            if (value.length >= minlength ) {
                                                if (searchRequest != null)
                                                    searchRequest.abort();
                                                searchRequest = $.ajax({
                                                    type: "GET",
                                                    url: "{{ path('ajax_search') }}",
                                                    data: {
                                                        'q' : value
                                                    },
                                                    dataType: "text",
                                                    success: function(msg){
                                                        //we need to check if the value is the same
                                                        if (value===$(that).val()) {
                                                            var result = JSON.parse(msg);
                                                            $.each(result, function(key, arr) {
                                                                $.each(arr, function(id, value) {
                                                                    if (key === 'evenements') {
                                                                        if (id !== 'error') {
                                                                            entitySelector.append('<li>'+' Nom de classe: \n'+value+ '</li>');
                                                                        } else {
                                                                            entitySelector.append('<li class="errorLi">'+value+'</li>');
                                                                        }
                                                                    }
                                                                });
                                                            });
                                                        }
                                                    }
                                                });
                                            }
                                        });
                                    });
                                </script>
                                
    <table class="table">
                       <a href="{{ path('app_classe_print') }}" class="btn btn-primary">Générer PDF</a> <!-- Add this line for PDF generation -->

        <thead>
            <tr>
                <th>IdClasse</th>
                <th>Nomclasse</th>
                <th>Filiere</th>
                <th>Nbreetudi</th>
                <th>Niveaux</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for classe in classes %}
            <tr>
                <td>{{ classe.idClasse }}</td>
                <td>{{ classe.nomClasse }}</td>
                <td>{{ classe.filiere }}</td>
                <td>{{ classe.nbreetudi }}</td>
                <td>{{ classe.niveaux }}</td>
                <td>
                    <a href="{{ path('app_classe_show', {'idClasse': classe.idClasse}) }}">show</a>
                    <a href="{{ path('app_classe_edit', {'idClasse': classe.idClasse}) }}">edit</a>
                </td>
            </tr>
                 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            $("#search").on("keyup", function() {
                var value = $(this).val().toLowerCase();
                $("#datatable tr").filter(function() {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });

            });
        });
    </script>

        {% else %}
            <tr>
                <td colspan="6">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <a href="{{ path('app_classe_new') }}">Create new</a>
{% endblock %}
